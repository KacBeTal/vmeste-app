<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–í–ú–µ—Å—Ç–µ üåä | –ê–Ω–æ–Ω–∏–º–Ω—ã–π –æ–∫–µ–∞–Ω –ø–æ—Å–ª–∞–Ω–∏–π</title>
    
    <!-- OK.ru SDK -->
    <script type="text/javascript" src="//api.ok.ru/js/fapi5.js"></script>
    
    <!-- Supabase -->
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        :root {
            --primary: #4A90E2;
            --secondary: #50E3C2;
            --dark: #1A1A2E;
            --light: #F8F9FA;
            --accent: #FF6B8B;
            --ok-orange: #EE8C3A;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: linear-gradient(135deg, #0F2027, #203A43, #2C5364);
            color: var(--light);
            min-height: 100vh;
            line-height: 1.6;
            padding: 20px;
        }
        
        .loading {
            text-align: center;
            padding: 50px;
            font-size: 18px;
        }
        
        .loader {
            border: 4px solid rgba(255,255,255,0.1);
            border-top: 4px solid var(--secondary);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* –û—Å—Ç–∞–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ –æ—Å—Ç–∞—é—Ç—Å—è —Ç–∞–∫–∏–º–∏ –∂–µ –∫–∞–∫ –≤ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –≤–µ—Ä—Å–∏–∏ */
        .app-container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 0;
            border-bottom: 2px solid rgba(255,255,255,0.1);
            margin-bottom: 30px;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .logo h1 {
            font-size: 28px;
            background: linear-gradient(45deg, var(--secondary), var(--primary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .main-layout {
            display: grid;
            grid-template-columns: 300px 1fr 300px;
            gap: 25px;
        }
        
        .profile-card, .info-panel, .ocean-section {
            background: rgba(255,255,255,0.05);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 25px;
            border: 1px solid rgba(255,255,255,0.1);
        }
        
        .ocean-section {
            border: 2px solid rgba(74, 144, 226, 0.2);
        }
        
        /* –î–æ–±–∞–≤—å—Ç–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –∫–æ–¥–∞ */
    </style>
</head>
<body>
    <!-- –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É –ø–æ–∫–∞ –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–ª–æ—Å—å -->
    <div id="loading" class="loading">
        <div class="loader"></div>
        <p>–ó–∞–≥—Ä—É–∑–∫–∞ –í–ú–µ—Å—Ç–µ...</p>
        <p id="loading-status">–û–∂–∏–¥–∞–Ω–∏–µ OK.ru SDK</p>
    </div>
    
    <div id="app-container" style="display: none;">
        <!-- –í–µ—Å—å –≤–∞—à HTML –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∑–¥–µ—Å—å -->
        <div class="header">
            <div class="logo">
                <div class="logo-icon">üåä</div>
                <h1>–í–ú–µ—Å—Ç–µ</h1>
            </div>
            <div class="status" id="connection-status">
                <div class="status-dot"></div>
                <span>–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ...</span>
            </div>
        </div>
        
        <main class="main-layout">
            <!-- Left: Profile -->
            <aside class="profile-card">
                <div class="profile-header" id="profile-header">
                    <img src="" alt="Avatar" class="avatar" id="user-avatar" 
                         style="width: 70px; height: 70px; border-radius: 50%; border: 3px solid #50E3C2;">
                    <div class="profile-info">
                        <h3 id="user-name">–ó–∞–≥—Ä—É–∑–∫–∞...</h3>
                        <div class="status">
                            <div class="status-dot"></div>
                            <span id="user-status">online</span>
                        </div>
                    </div>
                </div>
                
                <div class="stats-grid" style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin: 20px 0;">
                    <div class="stat-item" style="text-align: center; padding: 12px; background: rgba(255,255,255,0.05); border-radius: 12px;">
                        <div class="stat-value" id="sent-count" style="font-size: 24px; font-weight: bold; color: #50E3C2;">0</div>
                        <div class="stat-label" style="font-size: 12px; opacity: 0.8; margin-top: 5px;">–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ</div>
                    </div>
                    <div class="stat-item" style="text-align: center; padding: 12px; background: rgba(255,255,255,0.05); border-radius: 12px;">
                        <div class="stat-value" id="caught-count" style="font-size: 24px; font-weight: bold; color: #50E3C2;">0</div>
                        <div class="stat-label" style="font-size: 12px; opacity: 0.8; margin-top: 5px;">–ü–æ–π–º–∞–Ω–æ</div>
                    </div>
                    <div class="stat-item" style="text-align: center; padding: 12px; background: rgba(255,255,255,0.05); border-radius: 12px;">
                        <div class="stat-value" id="likes-count" style="font-size: 24px; font-weight: bold; color: #50E3C2;">0</div>
                        <div class="stat-label" style="font-size: 12px; opacity: 0.8; margin-top: 5px;">–õ–∞–π–∫–æ–≤</div>
                    </div>
                    <div class="stat-item" style="text-align: center; padding: 12px; background: rgba(255,255,255,0.05); border-radius: 12px;">
                        <div class="stat-value" id="days-count" style="font-size: 24px; font-weight: bold; color: #50E3C2;">1</div>
                        <div class="stat-label" style="font-size: 12px; opacity: 0.8; margin-top: 5px;">–î–Ω–µ–π —Å –Ω–∞–º–∏</div>
                    </div>
                </div>
                
                <div class="action-buttons" style="display: grid; gap: 15px;">
                    <button class="btn btn-secondary" onclick="refreshProfile()" style="padding: 12px; background: rgba(255,255,255,0.1); color: white; border: 1px solid rgba(255,255,255,0.2); border-radius: 10px; cursor: pointer;">
                        üîÑ –û–±–Ω–æ–≤–∏—Ç—å
                    </button>
                    <button class="btn btn-secondary" onclick="showAbout()" style="padding: 12px; background: rgba(255,255,255,0.1); color: white; border: 1px solid rgba(255,255,255,0.2); border-radius: 10px; cursor: pointer;">
                        ‚ÑπÔ∏è –û –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏
                    </button>
                </div>
            </aside>
            
            <!-- Center: Ocean -->
            <section class="ocean-section">
                <h2 class="ocean-title" style="text-align: center; margin-bottom: 30px; font-size: 24px;">
                    <span>üåä –û–∫–µ–∞–Ω –ø–æ—Å–ª–∞–Ω–∏–π</span>
                </h2>
                
                <div class="action-buttons" style="display: grid; gap: 15px; margin-bottom: 30px;">
                    <button class="btn btn-primary" onclick="showSendMessage()" style="padding: 16px 24px; background: linear-gradient(45deg, #4A90E2, #50E3C2); color: white; border: none; border-radius: 15px; font-size: 16px; font-weight: 600; cursor: pointer;">
                        ‚úçÔ∏è –ë—Ä–æ—Å–∏—Ç—å –ø–æ—Å–ª–∞–Ω–∏–µ
                    </button>
                    <button class="btn btn-primary" onclick="catchRandomMessage()" style="padding: 16px 24px; background: linear-gradient(45deg, #4A90E2, #50E3C2); color: white; border: none; border-radius: 15px; font-size: 16px; font-weight: 600; cursor: pointer;">
                        üé£ –ü–æ–π–º–∞—Ç—å –ø–æ—Å–ª–∞–Ω–∏–µ
                    </button>
                </div>
                
                <div id="message-display">
                    <div class="message-bubble" style="background: rgba(255,255,255,0.1); border-radius: 20px; padding: 25px; margin-bottom: 20px; border: 1px solid rgba(255,255,255,0.1);">
                        <div class="message-content" style="font-size: 18px; line-height: 1.6; margin-bottom: 15px; font-style: italic;">
                            "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –í–ú–µ—Å—Ç–µ! –ë—Ä–æ—Å—å—Ç–µ —Å–≤–æ—ë –ø–µ—Ä–≤–æ–µ –ø–æ—Å–ª–∞–Ω–∏–µ –≤ –æ–∫–µ–∞–Ω –∏–ª–∏ –ø–æ–π–º–∞–π—Ç–µ —á—É–∂–æ–µ."
                        </div>
                        <div class="message-meta" style="display: flex; justify-content: space-between; font-size: 14px; opacity: 0.7;">
                            <span>üí¨ –°–∏—Å—Ç–µ–º–∞</span>
                            <span>–¢–æ–ª—å–∫–æ —á—Ç–æ</span>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- Right: Info -->
            <aside class="info-panel">
                <h3 class="info-title" style="color: #50E3C2; margin-bottom: 20px; font-size: 20px;">üìä –û –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏</h3>
                <p style="margin-bottom: 15px;">
                    <strong>"–í–ú–µ—Å—Ç–µ"</strong> ‚Äî —ç—Ç–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –¥–ª—è –∏—Å–∫—Ä–µ–Ω–Ω–µ–≥–æ –æ–±—â–µ–Ω–∏—è.
                </p>
                
                <div style="background: rgba(255,255,255,0.05); padding: 15px; border-radius: 12px; margin: 15px 0;">
                    <p style="font-size: 14px; font-style: italic; color: #50E3C2;">
                        "–ë—Ä–æ—Å–∞–π –≤ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ. –õ–æ–≤–∏ –æ—Ç–∫–ª–∏–∫. –û–±—â–∞–π—Å—è –ø–æ-–Ω–∞—Å—Ç–æ—è—â–µ–º—É."
                    </p>
                </div>
                
                <p style="margin-bottom: 10px;">
                    ‚Ä¢ <strong>–ê–Ω–æ–Ω–∏–º–Ω–æ—Å—Ç—å:</strong> –í–∞—à–∏ –ø–æ—Å–ª–∞–Ω–∏—è –Ω–µ –ø—Ä–∏–≤—è–∑–∞–Ω—ã –∫ –ø—Ä–æ—Ñ–∏–ª—é
                </p>
                <p style="margin-bottom: 10px;">
                    ‚Ä¢ <strong>–°–ª—É—á–∞–π–Ω–æ—Å—Ç—å:</strong> –õ–æ–≤–∏—Ç–µ –ø–æ—Å–ª–∞–Ω–∏—è —Å–æ –≤—Å–µ–≥–æ –æ–∫–µ–∞–Ω–∞
                </p>
                <p style="margin-bottom: 10px;">
                    ‚Ä¢ <strong>–ò—Å–∫—Ä–µ–Ω–Ω–æ—Å—Ç—å:</strong> –¢–æ–ª—å–∫–æ –Ω–∞—Å—Ç–æ—è—â–∏–µ –º—ã—Å–ª–∏ –∏ —á—É–≤—Å—Ç–≤–∞
                </p>
                
                <div style="margin-top: 20px; padding-top: 15px; border-top: 1px solid rgba(255,255,255,0.1);">
                    <p style="font-size: 12px; opacity: 0.7;">
                        üîó –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å OK.ru<br>
                        üíæ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö Supabase<br>
                        üåê –û–Ω–ª–∞–π–Ω –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
                    </p>
                </div>
            </aside>
        </main>
    </div>
    
    <!-- Modals -->
    <div id="sendMessageModal" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.8); z-index: 1000; align-items: center; justify-content: center;">
        <div style="background: #1A1A2E; padding: 30px; border-radius: 20px; width: 90%; max-width: 500px; border: 2px solid #4A90E2;">
            <h3 style="margin-bottom: 20px; color: #50E3C2;">‚úçÔ∏è –ë—Ä–æ—Å–∏—Ç—å –ø–æ—Å–ª–∞–Ω–∏–µ –≤ –æ–∫–µ–∞–Ω</h3>
            <textarea id="messageInput" placeholder="–ß—Ç–æ –≤—ã —Ö–æ—Ç–∏—Ç–µ —Å–∫–∞–∑–∞—Ç—å –º–∏—Ä—É?" style="width: 100%; height: 150px; padding: 15px; border-radius: 12px; background: rgba(255,255,255,0.05); color: white; border: 1px solid rgba(255,255,255,0.2); font-size: 16px; resize: vertical;"></textarea>
            <div style="display: flex; gap: 10px; margin-top: 20px;">
                <button onclick="sendMessage()" class="btn btn-primary" style="flex: 1; padding: 12px; background: linear-gradient(45deg, #4A90E2, #50E3C2); color: white; border: none; border-radius: 10px; cursor: pointer;">
                    üåä –û—Ç–ø—Ä–∞–≤–∏—Ç—å
                </button>
                <button onclick="hideModal('sendMessageModal')" class="btn btn-secondary" style="flex: 1; padding: 12px; background: rgba(255,255,255,0.1); color: white; border: 1px solid rgba(255,255,255,0.2); border-radius: 10px; cursor: pointer;">
                    –û—Ç–º–µ–Ω–∞
                </button>
            </div>
        </div>
    </div>
    
    <script>
        // ========== –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø ==========
        const SUPABASE_URL = 'https://pyhatmplhbogwufatdga.supabase.co';
        const SUPABASE_KEY = 'sb_publishable_rEZH-AdtzcBxBGeEA1hthQ_Ev3YtQ6d';
        
        // ========== –ì–õ–û–ë–ê–õ–¨–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï ==========
        let supabaseClient = null;
        let currentUser = {
            ok_id: null,
            profile: null,
            supabase_id: null
        };
        
        // ========== –£–¢–ò–õ–ò–¢–´ ==========
        function updateLoadingStatus(message) {
            const statusEl = document.getElementById('loading-status');
            if (statusEl) {
                statusEl.textContent = message;
            }
            console.log('üîÑ ' + message);
        }
        
        function showApp() {
            document.getElementById('loading').style.display = 'none';
            document.getElementById('app-container').style.display = 'block';
        }
        
        function showError(message) {
            console.error('‚ùå ' + message);
            updateLoadingStatus('–û—à–∏–±–∫–∞: ' + message);
            // –ú–æ–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å –æ—à–∏–±–∫—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
        }
        
        // ========== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ==========
        async function initApp() {
            updateLoadingStatus('–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è...');
            
            try {
                // 1. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º Supabase
                if (typeof supabase === 'undefined') {
                    showError('Supabase SDK –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω');
                    return;
                }
                
                supabaseClient = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);
                console.log('‚úÖ Supabase –ø–æ–¥–∫–ª—é—á–µ–Ω');
                
                // 2. –ü—Ä–æ–≤–µ—Ä—è–µ–º OK SDK
                if (typeof FAPI === 'undefined') {
                    showError('OK.ru SDK –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω');
                    simulateUser();
                    return;
                }
                
                // 3. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º OK API
                updateLoadingStatus('–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ OK.ru...');
                await initOKAPI();
                
                // 4. –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
                showApp();
                
            } catch (error) {
                showError('–û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏: ' + error.message);
                simulateUser();
                showApp();
            }
        }
        
        async function initOKAPI() {
            return new Promise((resolve, reject) => {
                try {
                    // –ü–æ–ª—É—á–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ URL
                    const rParams = FAPI.Util.getRequestParameters();
                    console.log('–ü–∞—Ä–∞–º–µ—Ç—Ä—ã OK:', rParams);
                    
                    if (!rParams || !rParams.api_server) {
                        console.warn('–ù–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ OK.ru, —Ä–µ–∂–∏–º —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏');
                        simulateUser();
                        resolve();
                        return;
                    }
                    
                    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º FAPI
                    FAPI.init(
                        rParams.api_server,
                        rParams.apiconnection,
                        function() {
                            console.log('‚úÖ FAPI –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
                            loadOKUser();
                            resolve();
                        },
                        function(error) {
                            console.error('‚ùå –û—à–∏–±–∫–∞ FAPI:', error);
                            simulateUser();
                            resolve();
                        }
                    );
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ OK API:', error);
                    simulateUser();
                    resolve();
                }
            });
        }
        
        async function loadOKUser() {
            try {
                updateLoadingStatus('–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è...');
                
                FAPI.Client.call({
                    method: "users.getCurrentUser",
                    fields: "uid,first_name,last_name,pic_1,pic_2,pic_3,pic_4"
                }, async (method, result) => {
                    if (result && result.uid) {
                        console.log('‚úÖ –î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:', result);
                        
                        currentUser.ok_id = result.uid;
                        
                        // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
                        document.getElementById('user-name').textContent = 
                            `${result.first_name} ${result.last_name}`;
                        
                        // –ò—â–µ–º –ª—É—á—à—É—é –∞–≤–∞—Ç–∞—Ä–∫—É
                        const avatarUrl = result.pic_4 || result.pic_3 || result.pic_2 || result.pic_1;
                        if (avatarUrl) {
                            document.getElementById('user-avatar').src = avatarUrl;
                        }
                        
                        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ Supabase
                        await saveUserProfile(result, avatarUrl);
                        
                        // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å
                        document.getElementById('connection-status').innerHTML = `
                            <div class="status-dot" style="background: #50E3C2"></div>
                            <span>–ü–æ–¥–∫–ª—é—á–µ–Ω–æ –∫ OK.ru</span>
                        `;
                        
                    } else {
                        console.warn('–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è');
                        simulateUser();
                    }
                });
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:', error);
                simulateUser();
            }
        }
        
        async function saveUserProfile(okUser, avatarUrl) {
            if (!supabaseClient) return;
            
            try {
                const { data, error } = await supabaseClient
                    .from('profiles')
                    .upsert({
                        ok_id: okUser.uid,
                        first_name: okUser.first_name,
                        last_name: okUser.last_name,
                        avatar_url: avatarUrl,
                        last_seen: new Date().toISOString()
                    }, {
                        onConflict: 'ok_id'
                    })
                    .select()
                    .single();
                    
                if (error) {
                    console.error('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª—è:', error);
                    return;
                }
                
                currentUser.profile = data;
                currentUser.supabase_id = data.id;
                console.log('‚úÖ –ü—Ä–æ—Ñ–∏–ª—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω');
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞:', error);
            }
        }
        
        // ========== –†–ï–ñ–ò–ú –†–ê–ó–†–ê–ë–û–¢–ö–ò ==========
        function simulateUser() {
            console.log('üë§ –†–µ–∂–∏–º —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏');
            
            currentUser.ok_id = 588280768056;
            currentUser.supabase_id = 'dev-' + Date.now();
            
            document.getElementById('user-name').textContent = '–°—Ç–µ–ø–∞–Ω –ö–æ—Ä–æ–ª—ë–≤';
            document.getElementById('user-avatar').src = 'https://ui-avatars.com/api/?name=–°—Ç–µ–ø–∞–Ω+–ö–æ—Ä–æ–ª—ë–≤&background=4A90E2&color=fff&size=70';
            
            document.getElementById('connection-status').innerHTML = `
                <div class="status-dot" style="background: #FFA500"></div>
                <span>–†–µ–∂–∏–º —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏</span>
            `;
        }
        
        // ========== –û–°–ù–û–í–ù–´–ï –§–£–ù–ö–¶–ò–ò ==========
        function showSendMessage() {
            document.getElementById('sendMessageModal').style.display = 'flex';
        }
        
        function hideModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }
        
        async function sendMessage() {
            const text = document.getElementById('messageInput').value.trim();
            if (!text) return alert('–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç');
            
            try {
                const { data, error } = await supabaseClient
                    .from('messages')
                    .insert({
                        content: text,
                        sender_ok_id: currentUser.ok_id,
                        is_anonymous: true
                    })
                    .select()
                    .single();
                    
                if (error) throw error;
                
                alert('‚úÖ –ü–æ—Å–ª–∞–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ!');
                hideModal('sendMessageModal');
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞:', error);
                alert('‚ùå –û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏');
            }
        }
        
        function catchRandomMessage() {
            alert('üé£ –õ–æ–≤–∏–º —Å–ª—É—á–∞–π–Ω–æ–µ –ø–æ—Å–ª–∞–Ω–∏–µ...');
            // –†–µ–∞–ª–∏–∑—É–π—Ç–µ –ª–æ–≥–∏–∫—É –ø–æ–∑–∂–µ
        }
        
        function refreshProfile() {
            alert('–ü—Ä–æ—Ñ–∏–ª—å –æ–±–Ω–æ–≤–ª–µ–Ω');
        }
        
        function showAbout() {
            alert('üåä –í–ú–µ—Å—Ç–µ - –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –¥–ª—è –∏—Å–∫—Ä–µ–Ω–Ω–µ–≥–æ –æ–±—â–µ–Ω–∏—è');
        }
        
        // ========== –ó–ê–ü–£–°–ö ==========
        // –ñ–¥–µ–º –∑–∞–≥—Ä—É–∑–∫—É DOM –∏ –≤—Å–µ—Ö SDK
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üì± DOM –∑–∞–≥—Ä—É–∂–µ–Ω');
            
            // –î–∞–µ–º –≤—Ä–µ–º—è –Ω–∞ –∑–∞–≥—Ä—É–∑–∫—É SDK
            setTimeout(() => {
                initApp();
            }, 1500);
        });
        
        // –î–µ–ª–∞–µ–º —Ñ—É–Ω–∫—Ü–∏–∏ –≥–ª–æ–±–∞–ª—å–Ω—ã–º–∏
        window.showSendMessage = showSendMessage;
        window.catchRandomMessage = catchRandomMessage;
        window.sendMessage = sendMessage;
        window.hideModal = hideModal;
        window.showAbout = showAbout;
        window.refreshProfile = refreshProfile;
    </script>
</body>
</html>
